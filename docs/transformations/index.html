<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="ScalaPB Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="ScalaPB Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-346180-20","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Transformations | ScalaPB</title><meta data-react-helmet="true" property="og:image" content="https://scalapb.github.io/img/scalapb-social-light.png"><meta data-react-helmet="true" name="twitter:image" content="https://scalapb.github.io/img/scalapb-social-light.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for ScalaPB"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Transformations | ScalaPB"><meta data-react-helmet="true" name="description" content="Introduction"><meta data-react-helmet="true" property="og:description" content="Introduction"><meta data-react-helmet="true" property="og:url" content="https://scalapb.github.io//docs/transformations"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://scalapb.github.io//docs/transformations"><link rel="stylesheet" href="/styles.0bbc50d2.css">
<link rel="preload" href="/styles.022ff8f0.js" as="script">
<link rel="preload" href="/runtime~main.71653772.js" as="script">
<link rel="preload" href="/main.769d31ef.js" as="script">
<link rel="preload" href="/1.d1f2961e.js" as="script">
<link rel="preload" href="/2.f4df6e70.js" as="script">
<link rel="preload" href="/49.50d7d611.js" as="script">
<link rel="preload" href="/50.a4265ab1.js" as="script">
<link rel="preload" href="/935f2afb.5b2cd0a8.js" as="script">
<link rel="preload" href="/17896441.4580ba69.js" as="script">
<link rel="preload" href="/e901dba7.83a400db.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/ScalaPB.png" alt="ScalaPB" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/ScalaPB.png" alt="ScalaPB" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/scalapb/ScalaPB" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/ScalaPB.png" alt="ScalaPB" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/ScalaPB.png" alt="ScalaPB" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/scalapb/ScalaPB" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started">Tutorial</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Customizing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/customizations">Customizations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sbt-settings">SBT Settings</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/transformations">Transformations</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generated-code">Generated Code</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sealed-oneofs">Sealed oneofs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_defined_options">User-defined options</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/grpc">gRPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scala.js">Scala.js</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sparksql">SparkSQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/json">JSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scalapbc">ScalaPBC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dotty">Dotty</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/third-party-protos">Using third-party protos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/common-protos">Common protos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/validation">Validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generic">Generic programming</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/writing-plugins">Writing protoc plugins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/upgrading">Upgrading</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Getting Help</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contact">Contacting us</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Transformations</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">#</a></h2><p>Field transformations were introduced in ScalaPB 0.10.10 and allow you to automatically apply ScalaPB field-level options when a given field match certain conditions. In the future, we expect to have transformations for additional protobuf entities.</p><p>This document assumes that you are already familiar with:</p><ul><li><a href="https://developers.google.com/protocol-buffers/docs/proto#customoptions" target="_blank" rel="noopener noreferrer">Protocol Buffer custom options</a>.</li><li><a href="/docs/customizations">ScalaPB customizations</a> and type mappers.</li><li>Protobuf Descriptors, and specifically <a href="https://github.com/protocolbuffers/protobuf/blob/48234f5f012582843bb476ee3afef36cda94cb66/src/google/protobuf/descriptor.proto#L138-L239" target="_blank" rel="noopener noreferrer">FieldDescriptorProto</a>.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example-use-case"></a>Example use-case<a class="hash-link" href="#example-use-case" title="Direct link to heading">#</a></h2><p>Assume that your project uses a custom option called <code>sensitive</code>, and whenever this option is set to <code>true</code> on a <code>string</code> field, you would ScalaPB to use a custom type, <code>SensitiveString</code> instead of a standard <code>String</code>.</p><p>The custom option definition could look like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">// opts.proto</span></div><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto2&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package mypkg;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;google/protobuf/descriptor.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">extend google.protobuf.FieldOptions {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  optional MyCustomOptions opts = 50001;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message MyCustomOptions {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  optional bool  sensitive = 1;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  optional int32 num       = 2;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Example usage of the custom options:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">// usage.proto</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto3&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package mypkg;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;opts.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message User {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  string secret = 1 [(mypkg.opts).sensitive = true];</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>We want the type of <code>secret</code> in the case class to be <code>SensitiveString</code>. We could manually set
<code>(scalapb.field).type</code> to <code>SensitiveString</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">message User {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  string secret = 1 [(mypkg.opts).sensitive = true,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">                     (scalapb.field).type = &quot;mypkg.SensitiveString&quot;];</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>but it would be nice if there was a way to automatically apply <code>(scalapb.field).type</code> automatically whenever <code>sensitive</code> was set to true on a <code>string</code> field. This is the problem field transformations are set to solve:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">// Usage.proto:</span></div><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto3&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;opts.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  field_transformations : [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      when : {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        options {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">          [mypkg.opts]{sensitive : true}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        type: TYPE_STRING</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      set : {[scalapb.field] {type : &#x27;mypkg.SensitiveString&#x27;}}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message User {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  string secret = 1 [(mypkg.opts).sensitive = true];</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The transformation above matches when the custom option <code>senstive</code> is true, and the field type
is <code>string</code>. When it matches, it sets the ScalaPB option <code>type</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="syntax"></a>Syntax<a class="hash-link" href="#syntax" title="Direct link to heading">#</a></h2><p>FieldTransformations are defined in <a href="https://github.com/scalapb/ScalaPB/blob/master/protobuf/scalapb/scalapb.proto" target="_blank" rel="noopener noreferrer">scalapb.proto</a>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">enum MatchType {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  CONTAINS = 0;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  EXACT = 1;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  PRESENCE = 2;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message FieldTransformation {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  optional google.protobuf.FieldDescriptorProto when = 1;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  optional MatchType match_type = 2 [default=CONTAINS];</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  optional google.protobuf.FieldOptions set = 3;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>ScalaPB has a file-level option <code>field_transformations</code> which is a <code>repeated FieldTransformation</code>. The scope
of the field transformations is the same proto-file, and can be passed down to the entire package as a package-scoped
option (when <code>scope: PACKAGE</code> option is set).</p><p>A field transformation matches on the <code>when</code> condition which a <a href="https://github.com/protocolbuffers/protobuf/blob/48234f5f012582843bb476ee3afef36cda94cb66/src/google/protobuf/descriptor.proto#L138-L239" target="_blank" rel="noopener noreferrer">FieldDescriptorProto</a>. This allows it to match on the field&#x27;s type, or label (<code>LABEL_REPEATED</code>, <code>LABEL_OPTIONAL</code>, <code>LABEL_REQUIRED</code>), as well as on custom options like in the previous example. There are few matching modes that are described below and can be selected using <code>match_type</code>. The <code>set</code> field tells ScalaPB what options to apply to the field if the rule conditions match. Currently, only <code>[scalapb.field]</code> options  may appear in the <code>set</code> field.</p><p>There are three matching modes available:</p><ul><li><code>CONTAINS</code> is the default matching mode. In this mode, ScalaPB checks that all the options in the <code>when</code> pattern are defined on the field descriptor and having the same value (even if the field is repeated). Additional fields may be defined on the field besides the ones on the <code>when</code> pattern.</li><li><code>EXACT</code> is a strict equality comparison between the <code>when</code> pattern and the field descriptor.</li><li><code>PRESENCE</code> checks whether every field that is present on the <code>when</code> pattern is also present on the field&#x27;s rules. The specific value the option has is not compared. This allows matching on any value. For example, <code>{int32: {gt: 1}}</code> would match for any number assigned to <code>int32.gt</code>. For repeated fields, <code>PRESENCE</code> verifies that the value is not empty. </li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="referencing-rules-values"></a>Referencing rules values<a class="hash-link" href="#referencing-rules-values" title="Direct link to heading">#</a></h3><p>It is possible to reference values in the rules and use them on the <code>set</code> part. Whenever there is a singular string field under the field descriptor, ScalaPB would replace tokens in the format <code>$(p)</code> with the value of the field&#x27;s option at the path <code>p</code>, relative to the <code>FieldDescriptorProto</code> of the field. To reference extension fields, wrap the extension full name in brackets (<code>[]</code>). For example, <code>$(options.[pkg.opts].num)</code> would be substituted with the value of that option on the field. If the option is not set on the field, a default value will be replaced (0 for numeric types, empty string, and so on).</p><p>The paths that are referenced don&#x27;t have to appear on the <code>when</code> pattern. While referencing rule values is useful when the matching mode is <code>PRESENCE</code>, it is supported to reference rule values in all matching modes.</p><p>One application for this is in conjunction with <a href="https://github.com/fthomas/refined" target="_blank" rel="noopener noreferrer">refined types</a>. See example in <a href="/docs/validation#using-with-refined">ScalaPB validate documentation</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="example-customizing-third-party-types"></a>Example: customizing third-party types<a class="hash-link" href="#example-customizing-third-party-types" title="Direct link to heading">#</a></h2><p>When you want to customize your own messages, ScalaPB lets you add <a href="/docs/customizations#message-level-custom-type-and-boxing">custom
options</a> within the message is defined. You may also want to apply customizations to types defined in third-party protos which you can not change. To accomplish that, we can use field transformations. In the following example, we match on <code>google.protobuf.Timestamp</code> and map it to a custom type. In <code>src/main/protobuf/myexample/options.proto</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto2&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package com.e;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  scope: PACKAGE</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  field_transformations : [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      when : {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        type: TYPE_MESSAGE</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        type_name: &quot;.google.protobuf.Timestamp&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      set : {[scalapb.field] {type : &#x27;com.myexample.MyType&#x27; }}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  ]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Note the <code>.</code> (dot) prefix in the <code>type_name</code> field above. It is needed as <a href="https://github.com/protocolbuffers/protobuf/blob/68cb69ea68822d96eee6d6104463edf85e70d689/src/google/protobuf/descriptor.proto#L187-L192" target="_blank" rel="noopener noreferrer">explained here</a>. In this example we assume the user&#x27;s package is not named <code>google</code> or <code>google.protobuf</code> since then <code>type_name</code> could be relative and would not match.</p></div></div><p>Now, we need to make sure there is an implicit typemapper converting between <code>google.protobuf.timestamp.Timestamp</code> and <code>com.myexample.MyType</code>. The typemapper can be defined in the companion object of <code>MyType</code> as exampled in <a href="/docs/customizations#custom-types">custom types</a>.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/sbt-settings"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« SBT Settings</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/generated-code"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Generated Code Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link">Introduction</a></li><li><a href="#example-use-case" class="table-of-contents__link">Example use-case</a></li><li><a href="#syntax" class="table-of-contents__link">Syntax</a><ul><li><a href="#referencing-rules-values" class="table-of-contents__link">Referencing rules values</a></li></ul></li><li><a href="#example-customizing-third-party-types" class="table-of-contents__link">Example: customizing third-party types</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/installation">Installation</a></li><li class="footer__item"><a href="https://scalapb.github.io/api/scalapb" target="_blank" rel="noopener noreferrer" class="footer__link-item">ScalaDoc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/scalapb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://gitter.im/ScalaPB/community" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitter</a></li><li class="footer__item"><a href="https://groups.google.com/g/scalapb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google Groups</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/scalapb/ScalaPB" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2014-2023, <a href="https://www.linkedin.com/in/nadav-samet/">Nadav Samet</a></div></div></div></footer></div>
<script src="/styles.022ff8f0.js"></script>
<script src="/runtime~main.71653772.js"></script>
<script src="/main.769d31ef.js"></script>
<script src="/1.d1f2961e.js"></script>
<script src="/2.f4df6e70.js"></script>
<script src="/49.50d7d611.js"></script>
<script src="/50.a4265ab1.js"></script>
<script src="/935f2afb.5b2cd0a8.js"></script>
<script src="/17896441.4580ba69.js"></script>
<script src="/e901dba7.83a400db.js"></script>
</body>
</html>