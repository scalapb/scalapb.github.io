<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="ScalaPB Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="ScalaPB Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-346180-20","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Validating Protobufs | ScalaPB</title><meta data-react-helmet="true" property="og:image" content="https://scalapb.github.io/img/scalapb-social-light.png"><meta data-react-helmet="true" name="twitter:image" content="https://scalapb.github.io/img/scalapb-social-light.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for ScalaPB"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Validating Protobufs | ScalaPB"><meta data-react-helmet="true" name="description" content="scalapb-validate is a code generator that generates validation methods for your messages based on rules and constraints defined in the proto. It uses the same validation rules provided by protoc-gen-validate."><meta data-react-helmet="true" property="og:description" content="scalapb-validate is a code generator that generates validation methods for your messages based on rules and constraints defined in the proto. It uses the same validation rules provided by protoc-gen-validate."><meta data-react-helmet="true" property="og:url" content="https://scalapb.github.io//docs/validation"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://scalapb.github.io//docs/validation"><link rel="stylesheet" href="/styles.0bbc50d2.css">
<link rel="preload" href="/styles.022ff8f0.js" as="script">
<link rel="preload" href="/runtime~main.b7d21548.js" as="script">
<link rel="preload" href="/main.39137c98.js" as="script">
<link rel="preload" href="/1.d1f2961e.js" as="script">
<link rel="preload" href="/2.f4df6e70.js" as="script">
<link rel="preload" href="/49.50d7d611.js" as="script">
<link rel="preload" href="/50.a4265ab1.js" as="script">
<link rel="preload" href="/935f2afb.5b2cd0a8.js" as="script">
<link rel="preload" href="/17896441.4580ba69.js" as="script">
<link rel="preload" href="/10204607.1aebdf1e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img src="/img/ScalaPB.png" alt="ScalaPB" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/ScalaPB.png" alt="ScalaPB" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/scalapb/ScalaPB" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/ScalaPB.png" alt="ScalaPB" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/ScalaPB.png" alt="ScalaPB" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/scalapb/ScalaPB" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started">Tutorial</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Customizing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/customizations">Customizations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sbt-settings">SBT Settings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/transformations">Transformations</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generated-code">Generated Code</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sealed-oneofs">Sealed oneofs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_defined_options">User-defined options</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/grpc">gRPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scala.js">Scala.js</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sparksql">SparkSQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/json">JSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scalapbc">ScalaPBC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/dotty">Dotty</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/third-party-protos">Using third-party protos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/common-protos">Common protos</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/validation">Validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generic">Generic programming</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/writing-plugins">Writing protoc plugins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/upgrading">Upgrading</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_yu3-">Getting Help</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contact">Contacting us</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Validating Protobufs</h1></header><div class="markdown"><p><code>scalapb-validate</code> is a code generator that generates validation methods for your messages based on rules and constraints defined in the proto. It uses the same validation rules provided by <a href="https://github.com/envoyproxy/protoc-gen-validate" target="_blank" rel="noopener noreferrer">protoc-gen-validate</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">#</a></h2><p>In many situations, you may want to add validation rules for your messages. For example, you might want to enforce that a certain string field is an email address, or that a repeated field has at least one element.</p><p>Such rules and constraints can be defined using custom options defined in <code>validate/validate.proto</code>. Here is an example taken from <a href="https://github.com/envoyproxy/protoc-gen-validate/blob/master/README.md" target="_blank" rel="noopener noreferrer">protoc-gen-validate&#x27;s documentation</a>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto3&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package examplepb;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;validate/validate.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message Person {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  uint64 id    = 1 [(validate.rules).uint64.gt    = 999];</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  string email = 2 [(validate.rules).string.email = true];</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  string name  = 3 [(validate.rules).string = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">                      pattern:   &quot;^[^[0-9]A-Za-z]+( [^[0-9]A-Za-z]+)*$&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">                      max_bytes: 256,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">                   }];</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  Location home = 4 [(validate.rules).message.required = true];</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  message Location {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    double lat = 1 [(validate.rules).double = { gte: -90,  lte: 90 }];</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    double lng = 2 [(validate.rules).double = { gte: -180, lte: 180 }];</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>scalapb-validate supports all the rules available in protoc-gen-validate and is tested with the same test harness containing over 900 test cases.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="installation"></a>Installation<a class="hash-link" href="#installation" title="Direct link to heading">#</a></h2><p>Add the following to your <code>project/plugins.sbt</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">addSbtPlugin(&quot;com.thesamet&quot; % &quot;sbt-protoc&quot; % &quot;1.0.3&quot;)</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// For ScalaPB 0.11.x:</span></div><div class="token-line" style="color:#403f53"><span class="token plain">libraryDependencies ++= Seq(</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    &quot;com.thesamet.scalapb&quot; %% &quot;compilerplugin&quot;           % &quot;0.11.1&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    &quot;com.thesamet.scalapb&quot; %% &quot;scalapb-validate-codegen&quot; % &quot;0.3.1&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">)</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">// For ScalaPB 0.10.x:</span></div><div class="token-line" style="color:#403f53"><span class="token plain">libraryDependencies ++= Seq(</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    &quot;com.thesamet.scalapb&quot; %% &quot;compilerplugin&quot;           % &quot;0.10.11&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    &quot;com.thesamet.scalapb&quot; %% &quot;scalapb-validate-codegen&quot; % &quot;0.2.2&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Change your <code>PB.targets</code> to generate the validation code. The output directory must be the same as the one used for <code>scalapb.gen</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">Compile / PB.targets := Seq(</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  scalapb.gen() -&gt; (Compile / sourceManaged).value / &quot;scalapb&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  scalapb.validate.gen() -&gt; (Compile / sourceManaged).value / &quot;scalapb&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">)</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">libraryDependencies ++= Seq(</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;com.thesamet.scalapb&quot; %% &quot;scalapb-validate-core&quot; % scalapb.validate.compiler.BuildInfo.version % &quot;protobuf&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Note that we are adding <code>scalapb-validate-core</code> as a <code>protobuf</code> dependency. This makes it possible to import <code>validate/validate.proto</code> from your own protos.</p><p>If <a href="/docs/sbt-settings#additional-options-to-the-generator">ScalaPB generator parameters</a> are passed via <code>scalapb.gen(options: GeneratorOption*)</code>, the same parameters must be passed to <code>scalapb.validate.gen(options: GeneratorOption*)</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="using-the-generated-code"></a>Using the generated code<a class="hash-link" href="#using-the-generated-code" title="Direct link to heading">#</a></h2><p>Generated code for both ScalaPB and scalapb-validate is generated at compilation time. In <code>sbt</code>, just type <code>compile</code>.</p><p>In addition to the standard ScalaPB generated files, scalapb-validate will generate a validator object for each message based on its protoc-gen-validate rules. For a message named <code>Msg</code> the validator object will be named <code>MsgValidator</code> and will extend <code>scalapb.validate.Validator[Msg]</code>. An implicit instance of the validator is added to the companion object of each message, which makes it possible to write <code>Validator[Msg]</code> to obtain an instance of the validator.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="validators"></a>Validators<a class="hash-link" href="#validators" title="Direct link to heading">#</a></h2><p>The validator object is an object with a <code>validate</code> method that takes an instance of a message and returns the validation result: The <code>Validator[T]</code> is defined as follows:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">trait Validator[T] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  def validate(t: T): Result</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>where <code>Result</code> is a data structure that can be either a <code>Success</code> or a <code>Failure</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">sealed trait Result {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  def isSuccess: Boolean</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  def isFailure: Boolean</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">case object Success extends Result { ... }</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">case class Failure(violations: List[ValidationException]) extends Result { ... }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Therefore, the validation for the test person casn be run like this:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">Validator[Person].validate(personInstance) match {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  case Success             =&gt; println(&quot;Success!&quot;)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  case Failure(violations) =&gt; println(violations)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="package-scoped-extension-options"></a>Package-scoped extension options<a class="hash-link" href="#package-scoped-extension-options" title="Direct link to heading">#</a></h2><p>ScalaPB-validate further extends ScalaPB&#x27;s package-scoped options to achieve additional customization:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto2&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package mypkg;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/validate.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  scope: PACKAGE</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  [scalapb.validate.file] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      validate_at_construction: true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      insert_validator_instance: true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      skip: false</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><ul><li><code>validate_at_construction</code> when true, a check for validity is added to the message class body, so construction of invalid messages results in a validation exception. Default: <code>false</code>.</li><li><code>insert_validator_instance</code> when true, implicit instance of a <code>Validator</code> is added to the companion object of the message. This enables writing <code>Validator[MyMsg].validate(instance)</code>. Default: <code>true</code>.</li><li><code>skip</code> when true, skips gnerating validators for messages defined in this file. This can be set for a third-party package to work around the problem that there are no validators for it. See <a href="https://github.com/scalapb/scalapb-validate/tree/master/e2e/src/main/protobuf/skip" target="_blank" rel="noopener noreferrer">this testcase</a> for a usage example.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="rule-based-type-customization"></a>Rule-based type customization<a class="hash-link" href="#rule-based-type-customization" title="Direct link to heading">#</a></h2><p>Starting from version 0.10.10, ScalaPB provides a way to customize its own options by writing rules that are matched against
arbitrary protobuf options. When these rules are matched, additional ScalaPB options are added to the matched entity. For example, you can create a transformation that whenever a field has a PGV-rule like <code>int32: { gt: 0 }}</code>, then it will be typemapped to a custom class <code>PositiveInt</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="installation-1"></a>Installation<a class="hash-link" href="#installation-1" title="Direct link to heading">#</a></h3><p>The features described in this section have the following version requirements:</p><ul><li>sbt-protoc &gt;= <code>1.0.0</code></li><li>ScalaPB &gt;= <code>0.10.10</code></li><li>scalapb-validate &gt;= <code>0.2.0</code></li></ul><p>While field transformation is a generic ScalaPB mechanism, it is also recommended that you add
scalapb-validate&#x27;s preprocessor to <code>PB.targets</code>. The preprocessor does two things:</p><ol><li>Provides field transformations for <code>Set</code> and cats data types.</li><li>Expand your PGV-based rules such that they match repeated items, map keys and map values.</li></ol><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-scala codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">Compile / PB.targets := Seq(</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  scalapb.validate.preprocessor() -&gt; (Compile / sourceManaged).value / &quot;scalapb&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  scalapb.gen() -&gt; (Compile / sourceManaged).value / &quot;scalapb&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  scalapb.validate.gen() -&gt; (Compile / sourceManaged).value / &quot;scalapb&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">)</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">libraryDependencies ++= Seq(</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;com.thesamet.scalapb&quot; %% &quot;scalapb-validate-core&quot; % scalapb.validate.compiler.BuildInfo.version % &quot;protobuf&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  // If you are using Cats transformations:</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;com.thesamet.scalapb&quot; %% &quot;scalapb-validate-cats&quot; % scalapb.validate.compiler.BuildInfo.version,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  &quot;org.typelevel&quot; %% &quot;cats-core&quot; % &quot;2.3.0&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>There is an example project <a href="https://github.com/scalapb/scalapb-validate-demo" target="_blank" rel="noopener noreferrer">available on github</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="field-transformations"></a>Field transformations<a class="hash-link" href="#field-transformations" title="Direct link to heading">#</a></h3><p>If you want all positive integers to be typemapped to a Scala class called <code>PositiveInt</code> you can
create a proto file with the following content:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto2&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package mypackage;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/validate.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;validate/validate.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  preprocessors: [&quot;scalapb-validate-preprocessor&quot;]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  field_transformations: [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      when: {options { [validate.rules] {int32: {gt: 0}} }}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      set: {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        [scalapb.field] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">          type: &quot;mypkg.PositiveInt&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  ]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The scope of this definition is the entire protobuf file it is found in. Field tranformations can also
be used in package-scoped options so they are passed to all files within the package.</p><p>You can learn more about <a href="/docs/transformations">field transformations in this page</a>.</p><p>More examples of field transformations usage:</p><p>The following rule with match whenever there is a <code>gt</code> field set, no matter to which value:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  preprocessors: [&quot;scalapb-validate-preprocessor&quot;]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  field_transformations: [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      when: {options { [validate.rules] {int32: {gt: 0}}}}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      match_type: PRESENCE</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      set: {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        [scalapb.field] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">          type: &quot;mypkg.GreaterThanAnything&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  ]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Since the <code>when</code> clause is <code>FieldDescriptorProto</code>, it is possible to match on <code>type</code> and <code>label</code>. For example,
the following will match only when the field is in a <code>repeated int32</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  preprocessors: [&quot;scalapb-validate-preprocessor&quot;]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  field_transformations: [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      when: {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        type: TYPE_INT32</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        label: LABEL_REPEATED</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        options { [validate.rules] {int32: {gt: 0}}}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      match_type: CONTAINS</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      set: {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        [scalapb.field] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">          type: &quot;mypkg.PositiveIntInRepeated&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  ]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="what-does-the-preprocessor-do"></a>What does the preprocessor do?<a class="hash-link" href="#what-does-the-preprocessor-do" title="Direct link to heading">#</a></h4><p>The preprocessor scans for <code>field_transformations</code> with <code>when</code> fields that contain <code>[validate.rules]</code> extensions. Whenever a <code>[validate.rules]</code> does contain a <code>repeated</code> or <code>map</code> validation rules it is assumed to be applied to a singleton type, so we add a copy of the rule for repeated, map-key and map-value context. For example, for this <code>PositiveInt</code> rule:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">{</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  when: {[validate.rules] {int32: {gt: 0}}}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  set: {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    type: &quot;mypkg.PositiveInt&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>the following field transformations will be automatically added by the preprocessor:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">    {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      when: {options{[validate.rules] {repeated: {int32: {gt: 0}}}}}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      set: {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        [scalapb.field] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">          type: &quot;mypkg.PositiveInt&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    },</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      when: {options{[validate.rules] {map: {keys: {int32: {gt: 0}}}}}}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      set: {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        [scalapb.field] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">          key_type: &quot;mypkg.PositiveInt&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    },</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      when: {options{[validate.rules] {map: {values: {int32: {gt: 0}}}}}}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      set: {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        [scalapb.field] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">          value_type: &quot;mypkg.PositiveInt&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>This saves you from writing those rules manually so the type transformation is applied in repeated fields or maps. Note that the rewrite mechanism rewrites the <code>type</code> in the original <code>set</code> field, into <code>key_type</code> or <code>value_type</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cats-non-empty-collections"></a>Cats non-empty collections<a class="hash-link" href="#cats-non-empty-collections" title="Direct link to heading">#</a></h3><p>Using rules like the ones defined above, it is possible to detect when a list or a map are non-empty (via. <code>{repeated: { min_items: 1}}</code> or <code>{map: {min_pairs: 1}}</code>, and map them to corresponding non-empty collections.  Cats collections require some additional adaptation to ScalaPB since their API is different enough from standard Scala collections. ScalaPB-validate comes with support to automatically map non-empty collections to <code>NonEmptyMap</code>, <code>NonEmptySet</code> and <code>NonEmptyList</code>. To enable, add the following to a proto file. The scope of the settings will be for the entire file. You can turn the setting on for the
entire package by adding <code>scope: PACKAGE</code>.</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto2&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package mypackage;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/validate.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  preprocessors: [&quot;scalapb-validate-preprocessor&quot;]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  [scalapb.validate.file] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    validate_at_construction : true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    cats_transforms : true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    unique_to_set : true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>As stated above, you will need to have <code>scalapb-validate-cats</code> listed in
<code>libraryDependencies</code>. The setting <code>unique_to_set</code> can be used independently
of cats to transform a repeated with <code>unique: true</code> rule to a set.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="unboxing-required-fields"></a>Unboxing required fields<a class="hash-link" href="#unboxing-required-fields" title="Direct link to heading">#</a></h3><p>If you use <code>validate.message.required</code> you can apply a transformation that
would set the <code>scalapb.field.required</code> option. As a result, the field will
not be boxed in an <code>Option</code> and parsing will throw an exception if the field
is missing. To set this transformation add the following to ScalaPB-validate&#x27;s options:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    field_transformations: [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">            when: {options: {[validate.rules] {message: {required: true}}}}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">            set: {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">              [scalapb.field] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">                required: true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">              }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">            }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    ]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="using-with-refined"></a>Using with refined<a class="hash-link" href="#using-with-refined" title="Direct link to heading">#</a></h3><p>As explained in <a href="/docs/transformations#referencing-rules-values">&quot;referencing rule values&quot;</a>, it is possible
to reference field descriptor values in the <code>set</code> part of field transformation.
A use case for this is with <a href="https://github.com/fthomas/refined" target="_blank" rel="noopener noreferrer">refined types</a>. For example, you can
define the following field transformations:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-protobuf codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto3&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package refined_test;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;validate/validate.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/validate.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  preprocessors : [ &quot;scalapb-validate-preprocessor&quot; ]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  import : &quot;eu.timepit.refined.api.Refined&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  import : &quot;eu.timepit.refined.numeric._&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  import : &quot;eu.timepit.refined.generic._&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  import : &quot;shapeless.{Witness =&gt; W}&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  field_transformations : [ {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    when : {options: {[validate.rules] {int32 : {gt : 1}}}}  // &lt;-- 1 can be replaced with any number</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    set : {type : &quot;Int Refined Greater[$(options.[validate.rules].int32.gt)]&quot;}</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    match_type : PRESENCE</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  } ]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message Test {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  int32 gt_test = 1 [ (validate.rules).int32 = {gt : 5} ];  // transformed to: Int Refined Greater[5]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>For this to work, a typemapper for refined types need to be either put in a package object in the same package where the code is generated, or be manually imported through <code>import</code> options.</p><p>The typemapper used in scalapb-validate tests is <a href="https://github.com/scalapb/scalapb-validate/blob/0.2.x-preview/e2e/src/main/scala/scalapb/transforms/refined/package.scala" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Additional resources:</p><ul><li><a href="https://github.com/scalapb/scalapb-validate/blob/0.2.x-preview/e2e/src/main/protobuf/transforms/refined/refined.proto" target="_blank" rel="noopener noreferrer">test proto files (refined.proto)</a>: note it uses <code>shapeless.Witness</code> since ScalaPB-validate is cross-tested for Scala 2.12 and Scala 2.13.</li><li><a href="https://github.com/scalapb/scalapb-validate/blob/0.2.x-preview/e2e/src/test/scala/scalapb/validate/transforms/refined/RefinedSpec.scala" target="_blank" rel="noopener noreferrer">end-to-end tests</a> demonstrating compile-time validation.</li></ul></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/common-protos"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Common protos</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/generic"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Writing generic code Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link">Introduction</a></li><li><a href="#installation" class="table-of-contents__link">Installation</a></li><li><a href="#using-the-generated-code" class="table-of-contents__link">Using the generated code</a></li><li><a href="#validators" class="table-of-contents__link">Validators</a></li><li><a href="#package-scoped-extension-options" class="table-of-contents__link">Package-scoped extension options</a></li><li><a href="#rule-based-type-customization" class="table-of-contents__link">Rule-based type customization</a><ul><li><a href="#installation-1" class="table-of-contents__link">Installation</a></li><li><a href="#field-transformations" class="table-of-contents__link">Field transformations</a></li><li><a href="#cats-non-empty-collections" class="table-of-contents__link">Cats non-empty collections</a></li><li><a href="#unboxing-required-fields" class="table-of-contents__link">Unboxing required fields</a></li><li><a href="#using-with-refined" class="table-of-contents__link">Using with refined</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/installation">Installation</a></li><li class="footer__item"><a href="https://scalapb.github.io/api/scalapb" target="_blank" rel="noopener noreferrer" class="footer__link-item">ScalaDoc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/scalapb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://gitter.im/ScalaPB/community" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitter</a></li><li class="footer__item"><a href="https://groups.google.com/g/scalapb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google Groups</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/scalapb/ScalaPB" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2014-2022, <a href="https://www.linkedin.com/in/nadav-samet/">Nadav Samet</a></div></div></div></footer></div>
<script src="/styles.022ff8f0.js"></script>
<script src="/runtime~main.b7d21548.js"></script>
<script src="/main.39137c98.js"></script>
<script src="/1.d1f2961e.js"></script>
<script src="/2.f4df6e70.js"></script>
<script src="/49.50d7d611.js"></script>
<script src="/50.a4265ab1.js"></script>
<script src="/935f2afb.5b2cd0a8.js"></script>
<script src="/17896441.4580ba69.js"></script>
<script src="/10204607.1aebdf1e.js"></script>
</body>
</html>