<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.60">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-346180-20","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Customizations | ScalaPB</title><meta data-react-helmet="true" property="og:image" content="https://scalapb.github.io/img/scalapb-social-light.png"><meta data-react-helmet="true" property="twitter:image" content="https://scalapb.github.io/img/scalapb-social-light.png"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for ScalaPB"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Customizations | ScalaPB"><meta data-react-helmet="true" name="description" content="ScalaPB File-level Options"><meta data-react-helmet="true" property="og:description" content="ScalaPB File-level Options"><meta data-react-helmet="true" property="og:url" content="https://scalapb.github.io//docs/customizations"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://scalapb.github.io//docs/customizations"><link rel="stylesheet" href="/styles.3e428e43.css">
<link rel="preload" href="/styles.c338bdcb.js" as="script">
<link rel="preload" href="/runtime~main.2f2c8bff.js" as="script">
<link rel="preload" href="/main.5328e48c.js" as="script">
<link rel="preload" href="/1.d833c8f7.js" as="script">
<link rel="preload" href="/2.e7267239.js" as="script">
<link rel="preload" href="/3.667dd805.js" as="script">
<link rel="preload" href="/1be78505.5f6527ce.js" as="script">
<link rel="preload" href="/46.1d5fd37b.js" as="script">
<link rel="preload" href="/20ac7829.b0da0b84.js" as="script">
<link rel="preload" href="/17896441.d61dd99e.js" as="script">
<link rel="preload" href="/1d35a65b.cdb7ff78.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/ScalaPB.png" alt="ScalaPB"><strong class="navbar__title"></strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/scalapb/ScalaPB" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx moon_6SPT"></span></div><div class="react-toggle-track-x"><span class="toggle_BsTx sun_152_"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/ScalaPB.png" alt="ScalaPB"><strong class="navbar__title"></strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">Docs</a></li><li class="menu__list-item"><a href="https://github.com/scalapb/ScalaPB" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menuLinkText_2zSB">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/installation">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started">Tutorial</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2zSB">Customizing</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/customizations">Customizations</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sbt-settings">SBT Settings</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2zSB">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/generated-code">Generated Code</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sealed-oneofs">Sealed oneofs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/user_defined_options">User-defined options</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/grpc">gRPC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scala.js">Scala.js</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/sparksql">SparkSQL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/json">JSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/scalapbc">ScalaPBC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/third-party-protos">Using third-party protos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/common-protos">Common protos</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/validation">Validation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/writing-plugins">Writing protoc plugins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/upgrading">Upgrading</a></li></ul></li><li class="menu__list-item"><a class="menu__link menuLinkText_2zSB">Getting Help</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/faq">FAQ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/contact">Contacting us</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Customizations</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="scalapb-file-level-options"></a>ScalaPB File-level Options<a aria-hidden="true" tabindex="-1" class="hash-link" href="#scalapb-file-level-options" title="Direct link to heading">#</a></h2><p>ScalaPB file-level options lets you</p><ul><li>specify the name of the Scala package to use (the default is using the java package name).</li><li>request that ScalaPB will not append the protofile name to the package name.</li><li>specify Scala imports so custom base traits and custom types (see below) do
not require the full class name.</li></ul><p>The file-level options are not required, unless you are interested in those
customizations. If you do not want to customize the defaults, you can safely
skip this section.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="file-level-options"></a>File-level options<a aria-hidden="true" tabindex="-1" class="hash-link" href="#file-level-options" title="Direct link to heading">#</a></h2><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  scope: FILE</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  package_name: &quot;com.example.myprotos&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  flat_package: true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  single_file: true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  import: &quot;com.thesamet.pb.MyType&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  import: &quot;com.thesamet.other._&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  preamble: &quot;sealed trait BaseMessage&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  preamble: &quot;sealed trait CommonMessage&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  lenses: true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  retain_source_code_info: false</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  no_default_values_in_constructor: false</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  preserve_unknown_fields: false</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  enum_value_naming: CAMEL_CASE</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  enum_strip_prefix: false</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  bytes_type: &quot;scodec.bits.ByteVector&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div></div></div><ul><li><p><code>scope</code> controls whether the specified options apply only for this proto
files or for the entire package. Default is <code>FILE</code>. See <a href="#package-scoped-options">package-scoped options</a>
for more details.</p></li><li><p><code>package_name</code> sets the Scala base package name, if this is not defined,
then it falls back to <code>java_package</code> and then to <code>package</code>.</p></li><li><p>Setting <code>flat_package</code> to true (default is <code>false</code>) makes ScalaPB not append
the protofile base name to the package name.  You can also apply this option
globally to all files by adding it to your <a href="/docs/sbt-settings">ScalaPB SBT Settings</a>.</p></li><li><p>The <code>single_file</code> option makes the generator output all messages and
enums to a single Scala file.</p></li><li><p>The <code>preamble</code> is a list of strings that is output at the top of the
generated Scala file. This option requires <code>single_file</code> to be set. It is
commonly used to define sealed traits that are extended using
<code>(scalapb.message).extends</code> - see custom base traits below and <a href="https://github.com/scalapb/ScalaPB/blob/master/e2e/src/main/protobuf/sealed_trait.proto" target="_blank" rel="noopener noreferrer">this example</a>.</p></li><li><p>The <code>object_name</code> option lets you customize the name of the generated class
that contains various file-level members such as descriptors and a list of
companion objects for the generated messages and enums. This is useful in
case you are running into issues where the generated class name conflicts
with other things in your project.</p></li><li><p>Setting <code>lenses</code> to <code>false</code> inhibits generation of lenses (default is <code>true</code>).</p></li><li><p>Setting <code>retain_source_code_info</code> to <code>true</code> retains information in the descriptor that
can be used to retrieve source code information from the descriptor at
runtime (such as comments and source code locations). This option is turned
off by default to conserve source size and memory at runtime. When this
option is enabled, use the <code>location</code> method on various descriptors to
access source code information.</p></li><li><p>By default, all non-required fields have default values in the constructor of the generated
case classes. When setting <code>no_default_values_in_constructor</code> to <code>true</code> no
default values will be generated for all fields.</p></li><li><p>Typically, enum values appear in UPPER_CASE in proto files, and ScalaPB generates case objects
with exactly the same name in Scala. If you would like ScalaPB to transform the names into CamelCase, set <code>enum_value_naming</code> to <code>CAMEL_CASE</code>.</p></li><li><p>It is a common practice in protobufs to prefix each enum value name with the name of the enum.
For example, an enum name <code>Size</code> may have values named <code>SIZE_SMALL</code> and <code>SIZE_LARGE</code>. When you set <code>enum_strip_prefix</code>
to <code>true</code>, ScalaPB will strip the enum&#x27;s name from each value name, and they would become <code>SMALL</code> and <code>LARGE</code>.
Then the name can be transformed to camel-case according to <code>enum_value_naming</code>. Note that the prefix that is removed
is the all-caps version of the enum name followed by an underscore.</p></li><li><p>By default, during deserialization only known fields are retained.
When setting <code>preserve_unknown_fields</code> to <code>true</code>, all generated messages in this file will preserve unknown fields.
This is default behaviour in java for Proto3 messages since 3.5.0.
In ScalaPB 0.10.0: the default of this field became <code>true</code> for consistency
with Java.</p></li><li><p>Use <code>bytes_type</code> to customize the Scala type used for the <code>bytes</code> field
type. You will need to have an implicit
<code>TypeMapper[com.google.protobuf.ByteString, YourType]</code> instance so ScalaPb
can convert back and forth to the type of your choice. That implicit will be
found if it is defined under <code>YourType</code> companion object, or on a package
object that matches the generated code (or any of its parent packages).</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="package-scoped-options"></a>Package-scoped options<a aria-hidden="true" tabindex="-1" class="hash-link" href="#package-scoped-options" title="Direct link to heading">#</a></h2><p>Note: this option is experimental and is available in ScalaPB 0.8.2 and later.</p><p>Sometimes you want to have the same file-level options applied to all
the proto files in your project.  To accomplish that, add a <code>package.proto</code>
file (the name does not matter) next to your proto files that looks like this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package com.mypackage;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  scope: PACKAGE</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  flat_package: true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div></div></div><p>All the options in this file will be applied to all proto files in the
package <code>com.mypackage</code> and its sub-packages.</p><p>There is no need to explictly import this file from other protos. If you are
using <code>sbt-protoc</code> and the file is in the proto source directory (default is
<code>src/main/protobuf</code>) then the file will be found and the options applied. If
you are invoking protoc in another way, you need to ensure that this
file is passed to protoc together with the rest of the files.</p><p>If you are generating Scala code for proto files that you don&#x27;t own, you can
use this feature to customize code generation by creating a <code>package.proto</code>
file for that third-party package and include it within your proto source
directory.</p><p>The following rules are applied when validating package-scoped options:</p><ul><li>At most one file in each package may provide package-scoped options.</li><li>Sub-packages may override package-scoped options provided by their parent
packages. The options are merged using the Protocol Buffers <code>mergeFrom</code>
semantics. Specifically, this implies that repeated fields such as <code>import</code>
and <code>preamble</code> are concatenated.</li><li>Proto files get the most specific package-scoped options for the package
they are in. File-level options defined in a proto file get merged with the
package-level options using <code>mergeFrom</code>.</li><li>Proto files with package-scoped options must have a <code>package</code> statement.
This is to prevent the possibility of options applied globally. Standard
classes that are shipped with ScalaPB already assume certain options, so
overriding options globally may lead to compilation errors.</li></ul><p>NOTE: If you are shipping a library that includes both protos and Scala generated code, and
downstream users are expected to import the protos you ship, then you need to import the package
options proto explicitly from all the proto files that are meant to inherit the options.  The
reason is that if you don&#x27;t do that, then downstream projects would not
process the proto package file which may lead to compilation errors.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="auxiliary-options"></a>Auxiliary options<a aria-hidden="true" tabindex="-1" class="hash-link" href="#auxiliary-options" title="Direct link to heading">#</a></h2><p>In some situations, you may want to set some options in a proto file, but without
modifying the original proto file or adding anything ScalaPB-specific to it. To accomplish
that, you can define auxiliary options under package-scoped options.</p><p>For example, if you are given this proto file:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto3&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package a.b.c;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message Foo {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  string hello = 1;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>You can add a file <code>package.proto</code> with the following content:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto3&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package a.b.c;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    scope: PACKAGE</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    aux_message_options: [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">            target: &quot;a.b.c.Foo&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">            options: {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">                extends: &quot;com.myexample.SomeTrait&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">            }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    ]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    aux_field_options: [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">            target: &quot;a.b.c.Foo.hello&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">            options: {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">                scala_name: &quot;goodbye&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">            }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    ]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div></div></div><p>The list <code>aux_message_options</code> contains options targeted at different messages define under the same proto package of the package-scoped options. The <code>target</code> name needs to be fully-qualified message name in the protobuf namespace. Similar to <code>aux_message_options</code>, we also have <code>aux_enum_options</code> and <code>aux_field_options</code>. See <a href="https://github.com/scalapb/ScalaPB/tree/master/e2e/src/main/protobuf/scoped" target="_blank" rel="noopener noreferrer">example usage here</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="primitive-wrappers"></a>Primitive wrappers<a aria-hidden="true" tabindex="-1" class="hash-link" href="#primitive-wrappers" title="Direct link to heading">#</a></h2><p>In proto 3, unlike proto 2, primitives are not wrapped in an option by default.
The standard technique to obtain an optional primitive is to wrap it inside a
message (since messages are provided inside an <code>Option</code>). Google provides
standard wrappers to the primitive types in
<a href="https://github.com/google/protobuf/blob/master/src/google/protobuf/wrappers.proto" target="_blank" rel="noopener noreferrer">wrappers.proto</a>.</p><p><code>primitive_wrappers</code> is enabled by default for ScalaPB&gt;=0.6.0. Whenever one
of the standard wrappers is used, it will be mapped to <code>Option[X]</code> where <code>X</code>
is a primitive type. For example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto3&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;google/protobuf/wrappers.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message MyMessage {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  google.protobuf.Int32Value my_int32 = 5;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>would generate</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-scala codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">case class MyMessage(myInt32: Option[Int]) extends ...</span></div></div></div></div></div><p>To disable primitive wrappers in a file:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  no_primitive_wrappers: true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div></div></div><p>In versions of ScalaPB prior to 0.6.0, primitive wrappers had to be turned on
manually in each file:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  primitive_wrappers: true</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="custom-base-traits-for-messages"></a>Custom base traits for messages<a aria-hidden="true" tabindex="-1" class="hash-link" href="#custom-base-traits-for-messages" title="Direct link to heading">#</a></h2><p>Note: this option is available in ScalaPB 0.6.1 and later.</p><p>ScalaPBs allows you to specify custom base traits to a generated case
class.  This is useful when you have a few messages that share common fields
and you would like to be able to access those fields through a single trait.</p><p>Example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message CustomerWithPhone {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  option (scalapb.message).extends = &quot;com.thesamet.pb.BaseCustomer&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  optional string customer_id = 1;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  optional string name = 2;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  optional string phone = 3;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>In your code, define the base trait <code>DomainEvent</code> and include any subset of the fields:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-scala codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">package com.thesamet.pb</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">trait BaseCustomer {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  def customerId: Option[String]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  def name: Option[String]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>You can specify any number of base traits for a message.</p><p>It is also possible to make the generated companion classes extend a class
or trait, by using the <code>companion_extends</code> option. For example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">message MyMessage {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  option (scalapb.message).extends = &quot;MySuperClass&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  option (scalapb.message).companion_extends = &quot;MySuperCompanionClass&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  int32 n = 1;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>Will generate a case class that extends <code>MySuperClass</code>, and the companion
object will extend <code>MySuperCompanionClass</code>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="custom-base-traits-for-sealed-oneofs"></a>Custom base traits for sealed oneofs<a aria-hidden="true" tabindex="-1" class="hash-link" href="#custom-base-traits-for-sealed-oneofs" title="Direct link to heading">#</a></h2><p>Note: this option is available in ScalaPB 0.9.0 and later.</p><p>Use the following option to define one or more base traits for a generated SealedOneof:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">message MyEither {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  option (scalapb.message).sealed_oneof_extends = &quot;MyBaseTrait&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  oneof sealed_value {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    Left left = 1;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    Right right = 2;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="custom-base-traits-for-enums"></a>Custom base traits for enums<a aria-hidden="true" tabindex="-1" class="hash-link" href="#custom-base-traits-for-enums" title="Direct link to heading">#</a></h2><p>In a similar fashion to custom base traits for messages, it is possible to
define custom base traits for enum types, for the companion objects of enum
types and even for specific values.</p><p>For example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto2&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package enum_example;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">enum MyEnum {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  option (scalapb.enum_options).extends = &quot;example.EnumOptions.EnumBase&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  option (scalapb.enum_options).companion_extends = &quot;example.EnumOptions.EnumCompanionBase&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  Unknown = 0;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  V1 = 1 [(scalapb.enum_value).extends = &quot;example.EnumOptions.ValueMixin&quot;];</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  V2 = 2;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>The generated code will look something like this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-scala codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">sealed trait MyEnum extends GeneratedEnum</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    with example.EnumOptions.EnumBase {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  /* ... */</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">object MyEnum extends GeneratedEnumCompanion[MyEnum]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    with example.EnumOptions.EnumCompanionBase {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  case object Unknown extends MyEnum { /* ... */ }</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  case object V1 extends MyEnum</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      with example.EnumOptions.ValueMixin { /* ... */ }</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  case object V2 extends MyEnum { /* ... */ }</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  /* ... */</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="custom-types"></a>Custom types<a aria-hidden="true" tabindex="-1" class="hash-link" href="#custom-types" title="Direct link to heading">#</a></h2><p>You can customize the Scala type of any field.  One use-case for this is when
you would like to use type-safe wrappers around primitive values to enforce unit
correctness. For example, instead of using a raw integer for time fields, you can
wrap them in a <code>Seconds</code> class.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message Connection {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  optional int32 timeout = 1 [(scalapb.field).type = &quot;mydomain.Seconds&quot;];</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>We would like to write code like this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-scala codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">val c = Connection().update(_.timeout := Seconds(5))</span></div></div></div></div></div><p>How will ScalaPB know how to convert from the original type (<code>Integer</code>) to the
custom type <code>Seconds</code>? For each custom type you need to define an implicit
<code>TypeMapper</code> that will tell ScalaPB how to convert between the custom type and
the base Scala type.  A good place to define this implicit is in the companion
class for your custom type, since the Scala compiler will look for a
typemapper there by default.  If your typemapper is defined elsewhere, you
will need to import it manually by using the <code>import</code> file-level option.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-scala codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">package mydomain</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">case class Seconds(v: Int) extends AnyVal</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">object Seconds {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  implicit val typeMapper = TypeMapper(Seconds.apply)(_.v)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p><code>TypeMapper</code> takes two function parameters. The first converts from the original type to
the custom type. The second function converts from the custom type to the
original type.</p><p>In addition to primitive values, you can customize enums and messages as well.</p><p>For more examples, see:</p><ul><li><a href="https://github.com/scalapb/ScalaPB/blob/master/e2e/src/main/protobuf/custom_types.proto" target="_blank" rel="noopener noreferrer"><code>custom_types.proto</code></a></li><li><a href="https://github.com/scalapb/ScalaPB/blob/master/e2e/src/main/scala/com/thesamet/pb/PersonId.scala" target="_blank" rel="noopener noreferrer"><code>PersonId.scala</code></a></li><li><a href="https://github.com/scalapb/ScalaPB/blob/master/e2e/src/test/scala/CustomTypesSpec.scala" target="_blank" rel="noopener noreferrer"><code>CustomTypesSpec.scala</code></a></li></ul><p>If you have a TypeMapper that maps a generated type into a type you don&#x27;t own
(such as <code>String</code>, or a third-party class) then you don&#x27;t have access to the
companion object to define the typemapper in. Instead, you can place the
typemapper in one of the parent package objects of the generated code. For
example, if you want to map an enum to a string, and the message containing it
goes into the <code>a.b.c</code> package, you can define the type mapper like this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-scala codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">// src/main/scala/a/b/c/package.scala:</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package a.b</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package object c {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  implicit val segmentType =</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    TypeMapper[SegmentType, String](_.name)(SegmentType.fromName(_).get)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="message-level-custom-type-and-boxing"></a>Message-level custom type and boxing<a aria-hidden="true" tabindex="-1" class="hash-link" href="#message-level-custom-type-and-boxing" title="Direct link to heading">#</a></h2><p>In the previous section you saw how to customize the type generated for a
specific field. ScalaPB also lets you specify a custom type at the message
level. When <code>type</code> is set at the message level, that type is used for all the
fields that use that message. This eliminates the need to specify <code>type</code> on each field
of this type.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">// duration.proto</span></div><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto3&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package mytypes;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message Duration {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    option (scalapb.message).type = &quot;mytypes.MyDurationClass&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    int32 seconds = 1;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>In a Scala file define an implicit mapper:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-scala codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import scalapb.TypeMapper</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import mytypes.duration.Duration</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">case class MyDurationClass(seconds: Int)</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">object MyDurationClass {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    implicit val tm = TypeMapper[Duration, MyDurationClass] {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        d: Duration =&gt; MyDurationClass(d.seconds) } {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">        m: MyDurationClass =&gt; Duration(m.seconds)</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    }</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>Now, each time you reference <code>Duration</code> in a proto file, the generated field in Scala code
will be of type <code>MyDuration</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto3&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package mytypes;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;duration.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message Usage {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    Duration dd = 1;           // will become dd: Option[MyDuration]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    repeated Duration ds = 2;  // will become ds: Seq[MyDuration]</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    // You can eliminate the boxing of an optional field in an Option by using</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    // no_box</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    Duration dd_nobox = 3 [(scalapb.field).no_box = true];  // will become ddNoBox: MyDuration</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>If you do not want any instance of your message to be boxed (regardless if it
has a custom type), you can set <code>no_box</code> at the message-level:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">// duration_nobox.proto</span></div><div class="token-line" style="color:#403f53"><span class="token plain">syntax = &quot;proto3&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">package mytypes;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message Duration {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    option (scalapb.message).type = &quot;mytypes.MyDurationType&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    option (scalapb.message).no_box = true;  // do not wrap in Option</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    int32 seconds = 1;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>Then when this message is used, it will not be wrapped in an <code>Option</code>. If
<code>no_box</code> is specified at the field level, it overrides the value specified at
the message level.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="custom-types-on-maps"></a>Custom types on maps<a aria-hidden="true" tabindex="-1" class="hash-link" href="#custom-types-on-maps" title="Direct link to heading">#</a></h2><p>Since version 0.6.0 it is possible to customize the key and value types of
maps. Like the custom types described above you will need to have a <code>TypeMapper</code>
for the custom type.</p><p>Example:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">message CustomMaps {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  // Will generate Map[String, com.thesamet.pb.Years]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  map&lt;string, int32&gt; string_to_year = 1 [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      (scalapb.field).value_type = &quot;com.thesamet.pb.Years&quot;];</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  // Will generate Map[PersonId, Int]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  map&lt;string, int32&gt; person_to_int = 2 [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      (scalapb.field).key_type = &quot;com.thesamet.pb.PersonId&quot;];</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  // Will generate Map[PersonId, com.thesamet.pb.Years]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  map&lt;string, int32&gt; person_to_year = 3 [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      (scalapb.field).key_type = &quot;com.thesamet.pb.PersonId&quot;,</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      (scalapb.field).value_type = &quot;com.thesamet.pb.Years&quot;];</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>Example: see <code>CustomMaps</code> in <a href="https://github.com/scalapb/ScalaPB/blob/master/e2e/src/main/protobuf/maps.proto" target="_blank" rel="noopener noreferrer">maps.proto</a></p><p>You can also customize the collection type used for a map. See the next
section for details.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="custom-collection-types"></a>Custom collection types<a aria-hidden="true" tabindex="-1" class="hash-link" href="#custom-collection-types" title="Direct link to heading">#</a></h2><p>By default, ScalaPB compiles repeated fields into a <code>Seq[T]</code>. When a message
is parsed from bytes, the default implementation instantiates a <code>Vector[T]</code>,
which is a subtype of <code>Seq[T]</code>.  You can instruct ScalaPB to use a different
collection type for one field by specifying the <code>collection_type</code> option. You
can also specify a <code>collection_type</code> for the entire proto file by specifying a
<code>collection_type</code> at the file-level.</p><p>If both are defined then the field-level setting wins.</p><p>Similar to <code>collection_type</code>, we have <code>map_type</code> for map types. By default,
ScalaPB generates <code>scala.collection.immutable.Map</code> for maps, and you can
customize it at the field level, or file-level by specifying a <code>map_type</code>
option.</p><p><code>map_type</code> was introduced in ScalaPB 0.8.5.</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">import &quot;scalapb/scalapb.proto&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">option (scalapb.options) = {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  collection_type: &quot;Set&quot;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">};</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">message CollTest {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    // Will generate Set[Int] due to file-level option.</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    repeated int32  rep1 = 1;</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    // Will generate an Array[String]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    repeated string rep2 = 2  [(scalapb.field).collection_type=&quot;Array&quot;];</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    // Will generate Seq[collection.immutable.Seq]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    repeated bool rep3 = 3  [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      (scalapb.field).collection_type=&quot;collection.immutable.Seq&quot;];</span></div><div class="token-line" style="color:#403f53"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    map&lt;int32, string&gt; my_map [</span></div><div class="token-line" style="color:#403f53"><span class="token plain">      (scalapb.field).map_type=&quot;collection.mutable.Map&quot;];</span></div><div class="token-line" style="color:#403f53"><span class="token plain">    ]</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><p>Note on mutable collection: ScalaPB assumes that all data is immutable. For example, the result
of <code>serializedSize</code> is cached in a private field. When choosing mutable collections, you must be
careful not to mutate any collection after it has been passed to any message, or you might get some
surprising results!</p><p>Note: using <code>Array</code> is not supported along with Java conversions.</p><p>Note: Most Scala collections can be used with this feature. If you are trying
to implement your own collection type, it may be useful to check <code>MyVector</code>
and <code>MyMap</code>, the simplest custom collection that is compatible with ScalaPB:</p><ul><li><a href="https://github.com/scalapb/ScalaPB/blob/master/e2e/src/main/scala-pre-2.13/com/thesamet/pb/MyVector.scala" target="_blank" rel="noopener noreferrer">MyVector.scala</a></li><li><a href="https://github.com/scalapb/ScalaPB/blob/master/e2e/src/main/scala-pre-2.13/com/thesamet/pb/MyMap.scala" target="_blank" rel="noopener noreferrer">MyMap.scala</a></li><li><a href="https://github.com/scalapb/ScalaPB/blob/master/e2e/src/main/protobuf/collection_types.proto" target="_blank" rel="noopener noreferrer">collection_types.proto</a></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="custom-names"></a>Custom names<a aria-hidden="true" tabindex="-1" class="hash-link" href="#custom-names" title="Direct link to heading">#</a></h2><p>Sometimes it may be useful to manually specify the name of a field in the
generated code.  For example, if you have a field named <code>hash_code</code>, then the
camel-case version of it would be <code>hashCode</code>. Since that name would conflict with
the <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#hashCode()" target="_blank" rel="noopener noreferrer"><code>hashCode()</code> method</a>
we inherit from Java, ScalaPB issues an error. You can tell ScalaPB to use an
alternative name by using the <code>scala_name</code> option:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">optional string hash_code = 1 [(scalapb.field).scala_name = &quot;myHashCode&quot;];</span></div></div></div></div></div><p>It is also possible to customize the Scala name of an enum value:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">enum MyEnum {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  DEFAULT = 0;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  FOO = 1 [(scalapb.enum_value).scala_name = &quot;Bar&quot;];</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="adding-annotations"></a>Adding annotations<a aria-hidden="true" tabindex="-1" class="hash-link" href="#adding-annotations" title="Direct link to heading">#</a></h2><p>Since ScalaPB 0.6.3, you can add annotations to the generated case classes like this:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-protobuf codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">message BarMessage {</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  option (scalapb.message).annotations = &quot;@mypackage.CustomAnnotation&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  option (scalapb.message).annotations = &quot;@mypackage.CustomAnnotation1&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">  option (scalapb.message).annotations = &quot;@mypackage.CustomAnnotation2&quot;;</span></div><div class="token-line" style="color:#403f53"><span class="token plain">}</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="adding-scalapbproto-to-your-project"></a>Adding scalapb.proto to your project<a aria-hidden="true" tabindex="-1" class="hash-link" href="#adding-scalapbproto-to-your-project" title="Direct link to heading">#</a></h2><p>The easiest way to get <code>protoc</code> to find <code>scalapb/scalapb.proto</code> when compiling
through SBT is by adding the following to your <code>build.sbt</code>:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#403f53;background-color:#FBFBFB"><div class="token-line" style="color:#403f53"><span class="token plain">libraryDependencies += &quot;com.thesamet.scalapb&quot; %% &quot;scalapb-runtime&quot; % scalapb.compiler.Version.scalapbVersion % &quot;protobuf&quot;</span></div></div></div></div></div><p>If you are invoking <code>protoc</code> manually, you will need to ensure that the files in
<a href="https://github.com/scalapb/ScalaPB/tree/master/protobuf" target="_blank" rel="noopener noreferrer"><code>protobuf</code></a>
directory are available to your project.</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/getting-started"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Protocol Buffer Tutorial: Scala</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/sbt-settings"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SBT Settings »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#scalapb-file-level-options" class="table-of-contents__link">ScalaPB File-level Options</a></li><li><a href="#file-level-options" class="table-of-contents__link">File-level options</a></li><li><a href="#package-scoped-options" class="table-of-contents__link">Package-scoped options</a></li><li><a href="#auxiliary-options" class="table-of-contents__link">Auxiliary options</a></li><li><a href="#primitive-wrappers" class="table-of-contents__link">Primitive wrappers</a></li><li><a href="#custom-base-traits-for-messages" class="table-of-contents__link">Custom base traits for messages</a></li><li><a href="#custom-base-traits-for-sealed-oneofs" class="table-of-contents__link">Custom base traits for sealed oneofs</a></li><li><a href="#custom-base-traits-for-enums" class="table-of-contents__link">Custom base traits for enums</a></li><li><a href="#custom-types" class="table-of-contents__link">Custom types</a></li><li><a href="#message-level-custom-type-and-boxing" class="table-of-contents__link">Message-level custom type and boxing</a></li><li><a href="#custom-types-on-maps" class="table-of-contents__link">Custom types on maps</a></li><li><a href="#custom-collection-types" class="table-of-contents__link">Custom collection types</a></li><li><a href="#custom-names" class="table-of-contents__link">Custom names</a></li><li><a href="#adding-annotations" class="table-of-contents__link">Adding annotations</a></li><li><a href="#adding-scalapbproto-to-your-project" class="table-of-contents__link">Adding scalapb.proto to your project</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/installation">Installation</a></li><li class="footer__item"><a href="https://scalapb.github.io/api/scalapb" target="_blank" rel="noopener noreferrer" class="footer__link-item">ScalaDoc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/scalapb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://gitter.im/ScalaPB/community" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitter</a></li><li class="footer__item"><a href="https://groups.google.com/g/scalapb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Google Groups</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/scalapb/ScalaPB" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright © 2014-2020, <a href="https://www.linkedin.com/in/nadav-samet/">Nadav Samet</a></div></div></div></footer></div>
<script src="/styles.c338bdcb.js"></script>
<script src="/runtime~main.2f2c8bff.js"></script>
<script src="/main.5328e48c.js"></script>
<script src="/1.d833c8f7.js"></script>
<script src="/2.e7267239.js"></script>
<script src="/3.667dd805.js"></script>
<script src="/1be78505.5f6527ce.js"></script>
<script src="/46.1d5fd37b.js"></script>
<script src="/20ac7829.b0da0b84.js"></script>
<script src="/17896441.d61dd99e.js"></script>
<script src="/1d35a65b.cdb7ff78.js"></script>
</body>
</html>