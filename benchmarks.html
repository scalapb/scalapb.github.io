<!DOCTYPE html><html><head><title>ScalaPB: Benchmarks</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Nadav Samet" /><meta name="description" content="Protocol buffer compiler for Scala" /><meta name="og:image" content="/img/poster.png" /><meta name="image" property="og:image" content="/img/poster.png" /><meta name="og:title" content="ScalaPB: Benchmarks" /><meta name="title" property="og:title" content="ScalaPB: Benchmarks" /><meta name="og:site_name" content="ScalaPB" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Protocol buffer compiler for Scala" /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="ScalaPB: Benchmarks" /><meta name="twitter:image" content="/img/poster.png" /><meta name="twitter:description" content="Protocol buffer compiler for Scala" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/css/pattern-style.css" /><link rel="stylesheet" href="/css/custom.css" /><script async="async">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-346180-20' , 'auto');
ga('send', 'pageview');
      </script></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"><span>ScalaPB</span></div></a></li> <li><a href="/" class="">About</a></li> <li><a href="/sbt-settings.html" class="">SBT Settings</a></li> <li><a href="/generated-code.html" class="">Generated code</a></li> <li><a href="/customizations.html" class="">Customizations</a></li> <li><a href="/sealed-oneofs.html" class="">Sealed oneofs</a></li> <li><a href="/user_defined_options.html" class="">User-defined options</a></li> <li><a href="/grpc.html" class="">gRPC</a></li> <li><a href="/scala.js.html" class="">Scala.js</a></li> <li><a href="/sparksql.html" class="">SparkSQL</a></li> <li><a href="/json.html" class="">JSON</a></li> <li><a href="/scalapbc.html" class="">ScalaPBC</a></li> <li><a href="/third-party-protos.html" class="">Using third-party protos</a></li> <li><a href="/common-protos.html" class="">Common protos</a></li> <li><a href="/api/scalapb/latest/" class="">API Docs</a></li> <li><a href="/faq.html" class="">FAQ</a></li> <li><a href="/migrating.html" class="">Migrating</a></li> <li><a href="/contact.html" class="">Contact us</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/scalapb/ScalaPB" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/scalapb/ScalaPB" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('ScalaPB Protocol buffer compiler for Scala');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('ScalaPB Protocol buffer compiler for Scala');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="scalapb" data-github-repo="ScalaPB"><div class="content-wrapper"><section><script src="https://cdn.plot.ly/plotly-1.41.3.min.js" type="text/javascript"></script>

<h1 id="scalapb-benchmarks">ScalaPB Benchmarks</h1>

<p>The following benchmarks were produced on a workstation with an Intel(R) Core(TM) i7-4770 CPU running at 3.40GHz with 32GB of RAM using jmh.</p>

<p>The benchmarks are built around proto definitions and a single instances of that definition. The serialization benchmark is serializing a fixed instance using <code class="language-plaintext highlighter-rouge">toByteArray</code> (note that the serialized size is only computed once and cached in that instance (this is also true for Java). The parsing test calls <code class="language-plaintext highlighter-rouge">parseFrom</code> over the same array of bytes.</p>

<p>Each benchmark is executed against multiple versions of ScalaPB, Scala 2.12 and Scala 2.13. For comparison, it is ran against Java protobuf (currently 3.11.1).</p>

<p>In 0.10.x, ScalaPB started to preserve unknown fields, which means that every generated class has an additional member called <code class="language-plaintext highlighter-rouge">unknownFields</code> that represents unknown fields that represents unknown fields encountered when <code class="language-plaintext highlighter-rouge">parseFrom</code> - as this introduces overhead in parsing, serialization, allocation and so on, that feature is enabled in the following benchmarks for all Scala versions.</p>

<p>The charts show the average time per operation in nanoseconds - lower is better.</p>

<p>Like any benchmarks, they should be taken with a grain of salt, especially when used to compare Java and Scala. If you are here to make a decision on which library to pick solely by looking at performance data, consider that:</p>

<ul>
  <li>The results are very sensitive to the JVM you use and other environment factors. You can change the “winner” of some of the benchmarks by changing the environment.</li>
  <li>Your specific protos and data may have different performance characteristics than the examples below.</li>
  <li>The overall conclusion is that the performance is similar (and fast!), give or take a few percentages. Make sure you are optimizing where the real bottlenecks are.</li>
</ul>

<h2 id="simplemessage">SimpleMessage</h2>

<p>A simple flat message:</p>

<div class="language-protobuf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">enum</span> <span class="n">Color</span> <span class="p">{</span>
  <span class="na">UNKNOWN</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="na">RED</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="na">GREEN</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="na">BLUE</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-protobuf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">message</span> <span class="nc">SimpleMessage</span> <span class="p">{</span>
  <span class="kt">int32</span> <span class="na">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kt">int32</span> <span class="na">j</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
  <span class="kt">bytes</span> <span class="na">k</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="n">Color</span> <span class="na">color</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<table class="table"><tr><td width="50%"><div id="div-scalapb.perf.SimpleMessageTest.parse"></div></td><td width="50%"><div id="div-scalapb.perf.SimpleMessageTest.serialize"></div></td></tr></table>
<script>Plotly.newPlot('div-scalapb.perf.SimpleMessageTest.parse', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[42.71546592961347,45.2181421001534,45.454713771667166,45.15207169604239,43.72061328109858,45.00115318002344,44.06692026383216],"name":"Scala 2.12","error_y":{"array":[1.3677533944447902,1.3012392560574497,0.5888941586852425,0.6432595893676449,0.7790102551755282,1.022724068794453,1.5331721403382943],"arrayminus":[1.3677533944447902,1.3012392560574497,0.5888941586852425,0.6432595893676449,0.7790102551755282,1.022724068794453,1.5331721403382943],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[42.15733980666218,41.121087336031266,43.28487888287784,42.97619845331229,40.7939849743464],"name":"Scala 2.13","error_y":{"array":[1.1688311576551698,0.9223314658589317,1.0692705045162398,1.2125079764055187,1.045349789364458],"arrayminus":[1.1688311576551698,0.9223314658589317,1.0692705045162398,1.2125079764055187,1.045349789364458],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[48.83251130873823,48.83251130873823,48.83251130873823,48.83251130873823,48.83251130873823,48.83251130873823,48.83251130873823],"name":"Java","legendgroup":"b","showlegend":false,"mode":"lines"}], {"title":"SimpleMessage parse","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>
<script>Plotly.newPlot('div-scalapb.perf.SimpleMessageTest.serialize', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[42.963565457748246,43.0545410254137,43.05870802439935,43.05239861717552,43.278415184780606,43.2948269096919,43.07966905839575],"name":"Scala 2.12","error_y":{"array":[0.08291375722375705,0.13176114231900726,0.11126062768578748,0.11029310543018767,0.1845564427554649,0.2719012499567839,0.10265279493101076],"arrayminus":[0.08291375722375705,0.13176114231900726,0.11126062768578748,0.11029310543018767,0.1845564427554649,0.2719012499567839,0.10265279493101076],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[38.03230390706614,37.96852626859763,37.93226199650663,37.96021896183315,37.85060270059924],"name":"Scala 2.13","error_y":{"array":[0.1222166195851031,0.08070959109431186,0.08094372305142628,0.09975022341112094,0.05760971018970196],"arrayminus":[0.1222166195851031,0.08070959109431186,0.08094372305142628,0.09975022341112094,0.05760971018970196],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[36.67848945332209,36.67848945332209,36.67848945332209,36.67848945332209,36.67848945332209,36.67848945332209,36.67848945332209],"name":"Java","legendgroup":"b","showlegend":true,"mode":"lines"}], {"title":"SimpleMessage serialize","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>

<h2 id="messagecontainer">MessageContainer</h2>

<div class="language-protobuf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">message</span> <span class="nc">MessageContainer</span> <span class="p">{</span>
  <span class="n">SimpleMessage</span> <span class="na">opt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">repeated</span> <span class="n">SimpleMessage</span> <span class="na">rep</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">//  [(scalapb.field).collection_type="List"];</span>
<span class="p">}</span>
</code></pre></div></div>

<table class="table"><tr><td width="50%"><div id="div-scalapb.perf.MessageContainerTest.parse"></div></td><td width="50%"><div id="div-scalapb.perf.MessageContainerTest.serialize"></div></td></tr></table>
<script>Plotly.newPlot('div-scalapb.perf.MessageContainerTest.parse', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[20707.105880227147,20197.90595968661,19909.065059415152,20800.84367023433,20122.1343841256,20060.505258717425,20791.192636597316],"name":"Scala 2.12","error_y":{"array":[133.2480102013833,332.8614499496143,215.0435815082492,105.52980660738467,128.1624598408598,283.87431731734614,276.39101980741907],"arrayminus":[133.2480102013833,332.8614499496143,215.0435815082492,105.52980660738467,128.1624598408598,283.87431731734614,276.39101980741907],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[20103.28265696025,20315.031036110075,20114.667527417074,20092.245468714344,20498.169028246488],"name":"Scala 2.13","error_y":{"array":[130.81727108957784,149.6412435191014,105.91432397551034,97.58445478275098,218.28470943570937],"arrayminus":[130.81727108957784,149.6412435191014,105.91432397551034,97.58445478275098,218.28470943570937],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[23968.065270093004,23968.065270093004,23968.065270093004,23968.065270093004,23968.065270093004,23968.065270093004,23968.065270093004],"name":"Java","legendgroup":"b","showlegend":false,"mode":"lines"}], {"title":"MessageContainer parse","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>
<script>Plotly.newPlot('div-scalapb.perf.MessageContainerTest.serialize', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[17669.88070932487,17663.95012262804,17739.027043253092,17691.857771770276,17733.677454337812,17792.163045781585,17638.009820329036],"name":"Scala 2.12","error_y":{"array":[36.02573780239982,35.68002118138975,91.4049371945548,39.91244139412447,94.94831503976457,89.6861461431181,31.430424686066544],"arrayminus":[36.02573780239982,35.68002118138975,91.4049371945548,39.91244139412447,94.94831503976457,89.6861461431181,31.430424686066544],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[16182.756583557357,16213.259129720645,16216.194367194264,16221.416177401843,16136.522113998913],"name":"Scala 2.13","error_y":{"array":[74.55116346643081,79.66096672654567,67.81281899131136,44.567586892839245,58.990416140726666],"arrayminus":[74.55116346643081,79.66096672654567,67.81281899131136,44.567586892839245,58.990416140726666],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[16507.678947929366,16507.678947929366,16507.678947929366,16507.678947929366,16507.678947929366,16507.678947929366,16507.678947929366],"name":"Java","legendgroup":"b","showlegend":true,"mode":"lines"}], {"title":"MessageContainer serialize","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>

<h2 id="enum">Enum</h2>

<div class="language-protobuf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">message</span> <span class="nc">Enum</span> <span class="p">{</span>
  <span class="n">Color</span> <span class="na">color</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Java stores the enums as a primitive int inside a message class. ScalaPB is a little slower in serializing since it needs to call <code class="language-plaintext highlighter-rouge">.value</code> on the enum to convert to int.</p>

<table class="table"><tr><td width="50%"><div id="div-scalapb.perf.EnumTest.parse"></div></td><td width="50%"><div id="div-scalapb.perf.EnumTest.serialize"></div></td></tr></table>
<script>Plotly.newPlot('div-scalapb.perf.EnumTest.parse', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[25.91996158311413,25.98430887471609,25.84611852678156,25.856010457747107,25.95602428083259,25.84280091377858,25.868428448707782],"name":"Scala 2.12","error_y":{"array":[0.08774900689845566,0.16490234120767866,0.08485614654514961,0.12718432449257833,0.17778435405899273,0.06594719090938028,0.10912443358069268],"arrayminus":[0.08774900689845566,0.16490234120767866,0.08485614654514961,0.12718432449257833,0.17778435405899273,0.06594719090938028,0.10912443358069268],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[24.075660694061607,24.121463391096295,24.124812096182996,24.396155389323322,24.050269206638458],"name":"Scala 2.13","error_y":{"array":[0.059596593088752314,0.05963249063607279,0.06119534710840924,0.4078809171611759,0.04544873338178235],"arrayminus":[0.059596593088752314,0.05963249063607279,0.06119534710840924,0.4078809171611759,0.04544873338178235],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[30.031829591236704,30.031829591236704,30.031829591236704,30.031829591236704,30.031829591236704,30.031829591236704,30.031829591236704],"name":"Java","legendgroup":"b","showlegend":false,"mode":"lines"}], {"title":"Enum parse","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>
<script>Plotly.newPlot('div-scalapb.perf.EnumTest.serialize', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[18.543171848897593,18.577105940912812,18.582619857212975,18.703893455160298,18.586356383052316,18.57162051241285,18.565959030778625],"name":"Scala 2.12","error_y":{"array":[0.05099184733801465,0.04070428506819468,0.04033027271947276,0.07095589301456329,0.04388592671389446,0.06706052529187545,0.06676018994479449],"arrayminus":[0.05099184733801465,0.04070428506819468,0.04033027271947276,0.07095589301456329,0.04388592671389446,0.06706052529187545,0.06676018994479449],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[13.355494032803824,13.411336545369208,13.392640955975764,13.310917063156761,13.445322149072078],"name":"Scala 2.13","error_y":{"array":[0.032323601070691765,0.11582801467143788,0.03866918157350341,0.0441054318285552,0.07760961121693022],"arrayminus":[0.032323601070691765,0.11582801467143788,0.03866918157350341,0.0441054318285552,0.07760961121693022],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[11.646179224220205,11.646179224220205,11.646179224220205,11.646179224220205,11.646179224220205,11.646179224220205,11.646179224220205],"name":"Java","legendgroup":"b","showlegend":true,"mode":"lines"}], {"title":"Enum serialize","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>

<h2 id="stringmessage">StringMessage</h2>

<p>The Java implementation does a trick to save time when serializing the same instance multiple times. The reference to the string is replaced with a UTF8 ByteString representation of it, so the cost of encoding as UTF8 is paid only once. In normal usage, the same instance is unlikely to be serialized many times, so the difference should not matter to real-world applications.</p>

<div class="language-protobuf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">message</span> <span class="nc">StringMessage</span> <span class="p">{</span>
  <span class="kt">string</span> <span class="na">str1</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="kt">string</span> <span class="na">str2</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<table class="table"><tr><td width="50%"><div id="div-scalapb.perf.StringMessageTest.parse"></div></td><td width="50%"><div id="div-scalapb.perf.StringMessageTest.serialize"></div></td></tr></table>
<script>Plotly.newPlot('div-scalapb.perf.StringMessageTest.parse', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[82.58991531976484,81.05478792060806,81.4885591934085,81.26913245150311,81.40719526068894,81.99497172656406,82.29037403815374],"name":"Scala 2.12","error_y":{"array":[0.6605119091194638,0.254282094546852,0.650006995558428,0.35445456879527626,0.3482190956663942,0.628560280437469,1.2696074892493954],"arrayminus":[0.6605119091194638,0.254282094546852,0.650006995558428,0.35445456879527626,0.3482190956663942,0.628560280437469,1.2696074892493954],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[80.34105538508436,80.94052583407648,80.2073246221871,81.32443478349293,80.23429483180853],"name":"Scala 2.13","error_y":{"array":[0.1723870093035771,0.8422139083768201,0.2742606821362159,0.7230206999479662,0.17843935791321996],"arrayminus":[0.1723870093035771,0.8422139083768201,0.2742606821362159,0.7230206999479662,0.17843935791321996],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[82.88810294515473,82.88810294515473,82.88810294515473,82.88810294515473,82.88810294515473,82.88810294515473,82.88810294515473],"name":"Java","legendgroup":"b","showlegend":false,"mode":"lines"}], {"title":"StringMessage parse","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>
<script>Plotly.newPlot('div-scalapb.perf.StringMessageTest.serialize', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[44.26668088966194,44.69488598833801,44.96500948327224,44.99408336438,44.747806114645954,44.92432727377929,44.661321662911945],"name":"Scala 2.12","error_y":{"array":[0.4863262637215371,0.1229559064497252,0.16058297543409594,0.984782877507115,0.9003712276725224,0.13352215051722283,0.1526551560264835],"arrayminus":[0.4863262637215371,0.1229559064497252,0.16058297543409594,0.984782877507115,0.9003712276725224,0.13352215051722283,0.1526551560264835],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[40.16136868554713,40.18341984776047,40.511989474099266,40.22232875209978,40.114997410916935],"name":"Scala 2.13","error_y":{"array":[0.08495183444023269,0.13381662084935897,0.645623611287867,0.15940085505759782,0.10494277784651018],"arrayminus":[0.08495183444023269,0.13381662084935897,0.645623611287867,0.15940085505759782,0.10494277784651018],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[34.81186172654357,34.81186172654357,34.81186172654357,34.81186172654357,34.81186172654357,34.81186172654357,34.81186172654357],"name":"Java","legendgroup":"b","showlegend":true,"mode":"lines"}], {"title":"StringMessage serialize","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>

<h2 id="intvector">IntVector</h2>

<p>Here we parse and serialize a vector with hundreds of ints. The difference in performance is attributed partly to the performance difference of the underlying collection libraries.</p>

<div class="language-protobuf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">message</span> <span class="nc">IntVector</span> <span class="p">{</span>
  <span class="k">repeated</span> <span class="kt">int32</span> <span class="na">ints</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<table class="table"><tr><td width="50%"><div id="div-scalapb.perf.IntVectorTest.parse"></div></td><td width="50%"><div id="div-scalapb.perf.IntVectorTest.serialize"></div></td></tr></table>
<script>Plotly.newPlot('div-scalapb.perf.IntVectorTest.parse', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[524.700479328144,524.2000164619792,521.9824362434798,521.816335670096,526.4354809529295,528.8274342051777,524.5331159209312],"name":"Scala 2.12","error_y":{"array":[1.1283884519486946,1.672161844861762,5.716910809629212,5.077281314592483,1.1075570933736572,2.0889372552005625,1.3773601792695445],"arrayminus":[1.1283884519486946,1.672161844861762,5.716910809629212,5.077281314592483,1.1075570933736572,2.0889372552005625,1.3773601792695445],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[503.7136127446286,516.0693625543266,524.0302653383901,507.8902259706961,516.8326699555591],"name":"Scala 2.13","error_y":{"array":[5.317963343755196,7.503242970196766,2.2546090175934523,5.629639880521211,7.598947214529744],"arrayminus":[5.317963343755196,7.503242970196766,2.2546090175934523,5.629639880521154,7.598947214529801],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[616.5684878227432,616.5684878227432,616.5684878227432,616.5684878227432,616.5684878227432,616.5684878227432,616.5684878227432],"name":"Java","legendgroup":"b","showlegend":false,"mode":"lines"}], {"title":"IntVector parse","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>
<script>Plotly.newPlot('div-scalapb.perf.IntVectorTest.serialize', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[525.7912296958755,520.7085254949711,522.8712869034175,521.9022333565733,526.13512470778,525.6195820178036,518.7094086182087],"name":"Scala 2.12","error_y":{"array":[4.56749293462326,3.0840720030346347,2.615998151562053,4.214659152186414,4.261388551785558,2.878070278601058,3.551058556181033],"arrayminus":[4.56749293462326,3.0840720030346347,2.615998151562053,4.214659152186414,4.261388551785558,2.878070278601058,3.551058556181033],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[506.4452389365186,504.6439795376132,537.811928193563,599.1044708365126,511.58528860751557],"name":"Scala 2.13","error_y":{"array":[3.8768114974226364,3.843882246976648,31.104744452947216,38.8477211632395,1.6860839626369284],"arrayminus":[3.8768114974226364,3.843882246976648,31.104744452947273,38.8477211632395,1.6860839626368715],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[474.56274838336844,474.56274838336844,474.56274838336844,474.56274838336844,474.56274838336844,474.56274838336844,474.56274838336844],"name":"Java","legendgroup":"b","showlegend":true,"mode":"lines"}], {"title":"IntVector serialize","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>

<h2 id="enumvector">EnumVector</h2>

<div class="language-protobuf highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">message</span> <span class="nc">EnumVector</span> <span class="p">{</span>
  <span class="k">repeated</span> <span class="n">Color</span> <span class="na">colors</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<table class="table"><tr><td width="50%"><div id="div-scalapb.perf.EnumVectorTest.parse"></div></td><td width="50%"><div id="div-scalapb.perf.EnumVectorTest.serialize"></div></td></tr></table>
<script>Plotly.newPlot('div-scalapb.perf.EnumVectorTest.parse', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[5978.54078746784,5927.134394682379,5826.4114985219385,5860.014356033478,5680.497873018519,5860.538541094942,5950.321562855263],"name":"Scala 2.12","error_y":{"array":[62.01577162594549,83.08892271456807,67.47730877508184,82.14729950686706,83.0615785701084,52.25851864307697,48.514127461689895],"arrayminus":[62.01577162594549,83.08892271456807,67.47730877508184,82.14729950686706,83.0615785701084,52.25851864307697,48.514127461689895],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[5639.647217006916,5500.568097610192,5648.21968188906,5509.191459946888,5646.733283431927],"name":"Scala 2.13","error_y":{"array":[114.18215161013904,57.69947168646013,120.99255967992758,55.83140533077221,122.3326146945119],"arrayminus":[114.18215161013904,57.69947168646013,120.99255967992758,55.83140533077221,122.3326146945119],"type":"data"},"legendgroup":"a","showlegend":false,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[9942.341079929043,9942.341079929043,9942.341079929043,9942.341079929043,9942.341079929043,9942.341079929043,9942.341079929043],"name":"Java","legendgroup":"b","showlegend":false,"mode":"lines"}], {"title":"EnumVector parse","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>
<script>Plotly.newPlot('div-scalapb.perf.EnumVectorTest.serialize', [{"x":["0.7.4","0.8.10","0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[10276.855526698533,10288.061920582706,10289.918239334642,10297.572965637915,10284.0497599295,10341.036712952122,10319.207802003597],"name":"Scala 2.12","error_y":{"array":[20.67064048138127,29.531155824963207,20.54372415587386,20.482895835762974,21.59968274336825,62.48256351448617,49.701454788180854],"arrayminus":[20.67064048138127,29.531155824963207,20.54372415587386,20.482895835762974,21.59968274336825,62.48256351448617,49.701454788180854],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.9.6","0.10.0-M2","0.10.0-M3","0.10.0-M4","0.10.0-SNAPSHOT"],"y":[7230.1440324281775,7126.132721584364,6505.136068659207,6555.175818397244,6856.585800000416],"name":"Scala 2.13","error_y":{"array":[346.3903163976356,379.7281858035176,26.02699892075998,29.38316171677252,346.7338442482496],"arrayminus":[346.3903163976356,379.7281858035176,26.02699892075998,29.38316171677252,346.7338442482496],"type":"data"},"legendgroup":"a","showlegend":true,"type":"scatter"},{"x":["0.7.4","0.10.0-M2","0.9.6","0.8.10","0.10.0-SNAPSHOT","0.10.0-M4","0.10.0-M3"],"y":[6472.686211288716,6472.686211288716,6472.686211288716,6472.686211288716,6472.686211288716,6472.686211288716,6472.686211288716],"name":"Java","legendgroup":"b","showlegend":true,"mode":"lines"}], {"title":"EnumVector serialize","xaxis":{"title":"ScalaPB Version"},"yaxis":{"title":"ns/op","rangemode":"tozero"}}, {responsive: true});</script>

<h2 id="running-the-tests-on-your-own">Running the tests on your own</h2>

<p>Inside the main ScalaPB repository, change into the benchmarks directory. To run a single benchmark, in SBT:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jmh:run -t 1 -f 1 -i 5 -wi 5 -w 1 -r 1 "IntVectorTest.serializeScala"
</code></pre></div></div>

<p>To set the version of ScalaPB being used, set the ScalaPB environment variable:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SCALAPB=0.10.0-SNAPSHOT sbt
</code></pre></div></div>

<p>To generate the entire set of measurements used to produce this page, use ammonite to run:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>amm ./run_benchmarks.sc
</code></pre></div></div>

<p>To add an additional test scenario, register it in <code class="language-plaintext highlighter-rouge">projects/TestNames.scala</code> and add a test instance at <code class="language-plaintext highlighter-rouge">src/main/scala/TestCases.scala</code>.</p>
</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/highlight/highlight.pack.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/protobuf.min.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash','protobuf']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script>((window.gitter = {}).chat = {}).options = {
room: 'ScalaPB/community'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/js/main.js"></script></body></html>